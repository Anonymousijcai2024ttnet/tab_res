argv: ['/home/adrien/Documents/PhD/ICLR_TTrules/ttnet/__main__.py', 'TTnet', 'Adult_run/Permutation_false_1/2022_09_06_11_03_37_404738/', '--checkpoint', '1', '--input-quantization', '0.0', '--adv-epsilon', 'min(epoch/45, 1)*0.0', '--adv-step', 'min(epoch/22,0.9)*0.0+0', '--epoch', '10', '--lr', '0.005', '--dataset', 'adult', '--type_blocks', '[TTblock]', '--last_layer', 'binpos', '--Blocks_filters_output', '[10]', '--Blocks_amplifications', '[10]', '--Blocks_strides', '[5]', '--type_first_layer_block', 'float', '--kernel_size_per_block', '[5]', '--groups_per_block', '[1]', '--padding_per_block', '[0]', '--data_augmentation', 'False', '--thr_bin_act', '[0.0,0.0]', '--thr_bin_act_test', '[0.0,0.0]', '--DATA_DIR', 'dataset/adult/', '--random_permut', 'False', '--load_permut', 'dataset/adult/adult_original_mapping.json', '--repeat_permut', '1', '--kfold', '1', '--seed', '0']
parsed args: Namespace(Blocks_amplifications=[10], Blocks_filters_output=[10], Blocks_strides=[5], DATA_DIR='dataset/adult/', act_abs_stabilize='0', act_smp_stabilize='0', adv_epsilon='min(epoch/45, 1)*0.0', adv_loss='xent', adv_steps='min(epoch/22,0.9)*0.0+0', amplifications=None, batchsize=128, bias_hinge_coeff=0, bias_hinge_thresh=0, checkpoint=1, choose_epoch=3, choose_nr_minibatch=40, data='/home/adrien/Documents/PhD/ICLR_TTrules/ttnet/data', data_augmentation='False', dataset='adult', dataset_size=10000000, epoch=10, filters=None, first_layer=None, freeze_bn='False', g_remove_last_bn=None, grad_scale_start_epoch=15, groups=None, groups_per_block=[1], groups_per_block_multihead=None, input_quantization=0.0, kernel_size_per_block=[5], kernel_size_per_block_multihead=None, kernelsizes=None, kfold=1, last_layer='binpos', load=None, load_permut='dataset/adult/adult_original_mapping.json', loss='xent', lr=0.005, net='TTnet', nr=5, output='Adult_run/Permutation_false_1/2022_09_06_11_03_37_404738/', padding_per_block=[0], paddings=None, paddings_per_block_multihead=None, preprocessing_CNN=None, random_permut=False, repeat_permut=1, seed=0, set_global_param=[], start_epoch=0, strides=None, thr_bin_act=[0.0, 0.0], thr_bin_act_test=[0.0, 0.0], type_blocks=['TTblock'], type_first_layer_block='float', verifier_mix='0', verifier_nproc=4, wait_load=False, workers=2)
global params: [('g_weight_binarizer', <class 'ttnet.modules_general.TernaryWeightWithMaskFn'>), ('g_use_scalar_scale_last_layer', True)]
network: TTnet(
  (features): Sequential(
    (0): BNs()
    (1): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Binarize01Act()
    (3): Block_TT_1D(
      (conv1): Conv1d(1, 10, kernel_size=(5,), stride=(5,), bias=False)
      (bn1): BatchNorm1d(10, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv1d(10, 10, kernel_size=(1,), stride=(1,), bias=False)
      (bn2): BatchNorm1d(10, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (act): Binarize01Act()
    )
    (4): Flatten()
    (5): BinLinearPosv2(in_features=200, out_features=2, bias=False)
    (6): BatchNormStatsCallbak(2, scalar=True, cbd=0)
  )
)
WeightClip: 6 weight params
epoch: 0 ep.lr=0.005
[0, 0] loss=0.69/0.69 acc=75.78% tdata/train=(0.034,0.077)
[0, 20] loss=0.59/0.59 acc=66.41% tdata/train=(0.001,0.004)
[0, 40] loss=0.49/0.49 acc=77.34% tdata/train=(0.001,0.005)
[0, 60] loss=0.45/0.45 acc=82.81% tdata/train=(0.001,0.004)
[0, 80] loss=0.42/0.42 acc=79.69% tdata/train=(0.001,0.004)
[0, 100] loss=0.56/0.56 acc=71.09% tdata/train=(0.001,0.004)
[0, 120] loss=0.38/0.38 acc=82.81% tdata/train=(0.001,0.004)
[0, 140] loss=0.38/0.38 acc=82.81% tdata/train=(0.001,0.005)
[0, 160] loss=0.34/0.34 acc=85.94% tdata/train=(0.001,0.004)
[0, 180] loss=0.42/0.42 acc=83.59% tdata/train=(0.001,0.005)
[0, 200] loss=0.35/0.35 acc=88.28% tdata/train=(0.001,0.004)
sparsity@0: 86.25% ; 345/400.001=86.25%
test@0: acc=83.75% avg_acc=83.75% loss=0.37 pre_bn_acc=83.75%
epoch: 1 ep.lr=0.005
[1, 0] loss=0.32/0.32 acc=89.06% tdata/train=(1.319,1.327)
[1, 20] loss=0.43/0.43 acc=80.47% tdata/train=(0.001,0.005)
[1, 40] loss=0.29/0.29 acc=86.72% tdata/train=(0.001,0.005)
[1, 60] loss=0.52/0.52 acc=76.56% tdata/train=(0.001,0.005)
[1, 80] loss=0.37/0.37 acc=89.06% tdata/train=(0.001,0.005)
[1, 100] loss=0.36/0.36 acc=84.38% tdata/train=(0.001,0.005)
[1, 120] loss=0.40/0.40 acc=76.56% tdata/train=(0.001,0.005)
[1, 140] loss=0.37/0.37 acc=80.47% tdata/train=(0.001,0.005)
[1, 160] loss=0.30/0.30 acc=89.06% tdata/train=(0.001,0.005)
[1, 180] loss=0.34/0.34 acc=81.25% tdata/train=(0.001,0.006)
[1, 200] loss=0.41/0.41 acc=82.03% tdata/train=(0.001,0.005)
sparsity@1: 92.00% ; 368/400.001=92.00%
test@1: acc=83.00% avg_acc=83.38% loss=0.36 pre_bn_acc=83.00%
epoch: 2 ep.lr=0.005
[2, 0] loss=0.34/0.34 acc=86.72% tdata/train=(1.292,1.298)
[2, 20] loss=0.38/0.38 acc=79.69% tdata/train=(0.001,0.005)
[2, 40] loss=0.29/0.29 acc=89.84% tdata/train=(0.001,0.005)
[2, 60] loss=0.37/0.37 acc=82.81% tdata/train=(0.001,0.005)
[2, 80] loss=0.33/0.33 acc=82.81% tdata/train=(0.001,0.005)
[2, 100] loss=0.39/0.39 acc=78.12% tdata/train=(0.001,0.005)
[2, 120] loss=0.40/0.40 acc=80.47% tdata/train=(0.001,0.005)
[2, 140] loss=0.27/0.27 acc=89.84% tdata/train=(0.001,0.006)
[2, 160] loss=0.30/0.30 acc=85.94% tdata/train=(0.001,0.005)
[2, 180] loss=0.32/0.32 acc=85.16% tdata/train=(0.001,0.005)
[2, 200] loss=0.29/0.29 acc=84.38% tdata/train=(0.001,0.004)
sparsity@2: 94.00% ; 376/400.001=94.00%
test@2: acc=83.15% avg_acc=83.30% loss=0.35 pre_bn_acc=83.15%
epoch: 3 ep.lr=0.005
[3, 0] loss=0.35/0.35 acc=81.25% tdata/train=(1.332,1.339)
[3, 20] loss=0.36/0.36 acc=83.59% tdata/train=(0.001,0.004)
[3, 40] loss=0.39/0.39 acc=82.81% tdata/train=(0.001,0.005)
[3, 60] loss=0.26/0.26 acc=88.28% tdata/train=(0.001,0.005)
[3, 80] loss=0.26/0.26 acc=90.62% tdata/train=(0.001,0.005)
[3, 100] loss=0.34/0.34 acc=85.94% tdata/train=(0.001,0.005)
[3, 120] loss=0.38/0.38 acc=83.59% tdata/train=(0.001,0.005)
[3, 140] loss=0.32/0.32 acc=85.16% tdata/train=(0.001,0.005)
[3, 160] loss=0.34/0.34 acc=81.25% tdata/train=(0.001,0.005)
[3, 180] loss=0.37/0.37 acc=79.69% tdata/train=(0.001,0.005)
[3, 200] loss=0.30/0.30 acc=89.06% tdata/train=(0.001,0.004)
sparsity@3: 95.50% ; 382/400.001=95.50%
test@3: acc=82.97% avg_acc=83.22% loss=0.36 pre_bn_acc=82.19%
epoch: 4 ep.lr=0.005
[4, 0] loss=0.35/0.35 acc=79.69% tdata/train=(1.305,1.311)
[4, 20] loss=0.50/0.50 acc=77.34% tdata/train=(0.001,0.005)
[4, 40] loss=0.38/0.38 acc=80.47% tdata/train=(0.001,0.005)
[4, 60] loss=0.29/0.29 acc=89.06% tdata/train=(0.001,0.005)
[4, 80] loss=0.33/0.33 acc=86.72% tdata/train=(0.001,0.005)
[4, 100] loss=0.33/0.33 acc=84.38% tdata/train=(0.001,0.004)
[4, 120] loss=0.38/0.38 acc=80.47% tdata/train=(0.001,0.005)
[4, 140] loss=0.37/0.37 acc=85.94% tdata/train=(0.001,0.004)
[4, 160] loss=0.42/0.42 acc=80.47% tdata/train=(0.001,0.004)
[4, 180] loss=0.40/0.40 acc=79.69% tdata/train=(0.001,0.005)
[4, 200] loss=0.33/0.33 acc=84.38% tdata/train=(0.001,0.004)
sparsity@4: 96.00% ; 384/400.001=96.00%
test@4: acc=83.06% avg_acc=83.19% loss=0.37 pre_bn_acc=83.06%
epoch: 5 ep.lr=0.005
[5, 0] loss=0.24/0.24 acc=90.62% tdata/train=(1.372,1.379)
[5, 20] loss=0.31/0.31 acc=85.16% tdata/train=(0.001,0.005)
[5, 40] loss=0.34/0.34 acc=82.03% tdata/train=(0.001,0.005)
[5, 60] loss=0.37/0.37 acc=78.91% tdata/train=(0.001,0.005)
[5, 80] loss=0.39/0.39 acc=81.25% tdata/train=(0.001,0.005)
[5, 100] loss=0.38/0.38 acc=78.91% tdata/train=(0.001,0.005)
[5, 120] loss=0.37/0.37 acc=80.47% tdata/train=(0.001,0.005)
[5, 140] loss=0.31/0.31 acc=85.94% tdata/train=(0.001,0.005)
[5, 160] loss=0.40/0.40 acc=82.81% tdata/train=(0.001,0.004)
[5, 180] loss=0.34/0.34 acc=83.59% tdata/train=(0.001,0.005)
[5, 200] loss=0.36/0.36 acc=84.38% tdata/train=(0.001,0.005)
sparsity@5: 96.25% ; 385/400.001=96.25%
test@5: acc=81.94% avg_acc=82.98% loss=0.38 pre_bn_acc=81.94%
epoch: 6 ep.lr=0.005
[6, 0] loss=0.41/0.41 acc=78.12% tdata/train=(1.305,1.313)
[6, 20] loss=0.39/0.39 acc=78.12% tdata/train=(0.001,0.005)
[6, 40] loss=0.45/0.45 acc=75.00% tdata/train=(0.001,0.005)
[6, 60] loss=0.37/0.37 acc=82.81% tdata/train=(0.001,0.005)
[6, 80] loss=0.38/0.38 acc=78.12% tdata/train=(0.001,0.005)
[6, 100] loss=0.42/0.42 acc=80.47% tdata/train=(0.001,0.005)
[6, 120] loss=0.46/0.46 acc=81.25% tdata/train=(0.001,0.005)
[6, 140] loss=0.49/0.49 acc=79.69% tdata/train=(0.001,0.006)
[6, 160] loss=0.36/0.36 acc=85.16% tdata/train=(0.001,0.005)
[6, 180] loss=0.32/0.32 acc=87.50% tdata/train=(0.001,0.005)
[6, 200] loss=0.31/0.31 acc=86.72% tdata/train=(0.001,0.004)
sparsity@6: 97.00% ; 388/400.001=97.00%
test@6: acc=82.99% avg_acc=82.98% loss=0.39 pre_bn_acc=81.80%
epoch: 7 ep.lr=0.005
[7, 0] loss=0.41/0.41 acc=83.59% tdata/train=(1.369,1.376)
[7, 20] loss=0.36/0.36 acc=82.03% tdata/train=(0.001,0.005)
[7, 40] loss=0.42/0.42 acc=80.47% tdata/train=(0.001,0.005)
[7, 60] loss=0.36/0.36 acc=84.38% tdata/train=(0.002,0.010)
[7, 80] loss=0.30/0.30 acc=87.50% tdata/train=(0.002,0.010)
[7, 100] loss=0.33/0.33 acc=85.94% tdata/train=(0.002,0.010)
[7, 120] loss=0.39/0.39 acc=82.03% tdata/train=(0.002,0.010)
[7, 140] loss=0.44/0.44 acc=77.34% tdata/train=(0.002,0.011)
[7, 160] loss=0.40/0.40 acc=80.47% tdata/train=(0.001,0.004)
[7, 180] loss=0.42/0.42 acc=79.69% tdata/train=(0.001,0.005)
[7, 200] loss=0.33/0.33 acc=84.38% tdata/train=(0.001,0.005)
sparsity@7: 97.25% ; 389/400.001=97.25%
test@7: acc=83.83% avg_acc=83.09% loss=0.39 pre_bn_acc=83.83%
model choosing acc @7: 84.71%
best model update at @7
epoch: 8 ep.lr=0.005
[8, 0] loss=0.27/0.27 acc=88.28% tdata/train=(1.475,1.486)
[8, 20] loss=0.33/0.33 acc=85.94% tdata/train=(0.001,0.005)
[8, 40] loss=0.43/0.43 acc=78.91% tdata/train=(0.001,0.005)
[8, 60] loss=0.29/0.29 acc=87.50% tdata/train=(0.001,0.005)
[8, 80] loss=0.33/0.33 acc=87.50% tdata/train=(0.001,0.005)
[8, 100] loss=0.34/0.34 acc=84.38% tdata/train=(0.001,0.005)
[8, 120] loss=0.33/0.33 acc=82.03% tdata/train=(0.001,0.005)
[8, 140] loss=0.32/0.32 acc=89.84% tdata/train=(0.001,0.005)
[8, 160] loss=0.41/0.41 acc=80.47% tdata/train=(0.001,0.006)
[8, 180] loss=0.30/0.30 acc=89.06% tdata/train=(0.001,0.004)
[8, 200] loss=0.35/0.35 acc=81.25% tdata/train=(0.001,0.004)
sparsity@8: 97.50% ; 390/400.001=97.50%
test@8: acc=82.19% avg_acc=82.99% loss=0.41 pre_bn_acc=82.19%
model choosing acc @8: 83.54%
epoch: 9 ep.lr=0.005
[9, 0] loss=0.35/0.35 acc=83.59% tdata/train=(1.396,1.402)
[9, 20] loss=0.42/0.42 acc=78.12% tdata/train=(0.001,0.005)
[9, 40] loss=0.27/0.27 acc=91.41% tdata/train=(0.001,0.005)
[9, 60] loss=0.42/0.42 acc=80.47% tdata/train=(0.001,0.005)
[9, 80] loss=0.30/0.30 acc=85.16% tdata/train=(0.001,0.005)
[9, 100] loss=0.36/0.36 acc=83.59% tdata/train=(0.001,0.005)
[9, 120] loss=0.31/0.31 acc=86.72% tdata/train=(0.001,0.005)
[9, 140] loss=0.37/0.37 acc=82.81% tdata/train=(0.001,0.005)
[9, 160] loss=0.37/0.37 acc=84.38% tdata/train=(0.001,0.005)
[9, 180] loss=0.44/0.44 acc=75.78% tdata/train=(0.001,0.005)
[9, 200] loss=0.43/0.43 acc=78.91% tdata/train=(0.001,0.005)
sparsity@9: 98.25% ; 393/400.001=98.25%
test@9: acc=81.89% avg_acc=82.88% loss=0.40 pre_bn_acc=80.64%
model choosing acc @9: 82.64%
