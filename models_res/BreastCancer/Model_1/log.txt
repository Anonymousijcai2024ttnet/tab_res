argv: ['/home/ntu/Documents/research/rules_bench/ICLR_TTrules_copy/ttnet/__main__.py', 'TTnet', 'BreastCancer/2023_01_19_10_40_45_935916/', '--checkpoint', '1', '--input-quantization', '0.1', '--adv-epsilon', 'min(epoch/45, 1)*0.0', '--adv-step', 'min(epoch/22,0.9)*0.0+0', '--epoch', '10', '--lr', '0.005', '--dataset', 'breast_cancer', '--type_blocks', '[TTblock]', '--last_layer', 'binpos', '--Blocks_filters_output', '[5]', '--Blocks_amplifications', '[5]', '--Blocks_strides', '[2]', '--type_first_layer_block', 'float', '--kernel_size_per_block', '[3]', '--groups_per_block', '[1]', '--padding_per_block', '[0]', '--data_augmentation', 'False', '--thr_bin_act', '[0.0,0.0]', '--thr_bin_act_test', '[0.0,0.0]', '--DATA_DIR', 'dataset/breast_cancer/', '--random_permut', 'False', '--load_permut', 'dataset/breast_cancer/breast_cancer_original_mapping.json', '--repeat_permut', '1', '--kfold', '0', '--seed', '0']
parsed args: Namespace(Blocks_amplifications=[5], Blocks_filters_output=[5], Blocks_strides=[2], DATA_DIR='dataset/breast_cancer/', act_abs_stabilize='0', act_smp_stabilize='0', adv_epsilon='min(epoch/45, 1)*0.0', adv_loss='xent', adv_steps='min(epoch/22,0.9)*0.0+0', amplifications=None, batchsize=128, bias_hinge_coeff=0, bias_hinge_thresh=0, checkpoint=1, choose_epoch=3, choose_nr_minibatch=40, data='/home/ntu/Documents/research/rules_bench/ICLR_TTrules_copy/ttnet/data', data_augmentation='False', dataset='breast_cancer', dataset_size=10000000, epoch=10, filters=None, first_layer=None, freeze_bn='False', g_remove_last_bn=None, grad_scale_start_epoch=15, groups=None, groups_per_block=[1], groups_per_block_multihead=None, input_quantization=0.1, kernel_size_per_block=[3], kernel_size_per_block_multihead=None, kernelsizes=None, kfold=0, last_layer='binpos', load=None, load_permut='dataset/breast_cancer/breast_cancer_original_mapping.json', loss='xent', lr=0.005, net='TTnet', nr=5, output='BreastCancer/2023_01_19_10_40_45_935916/', padding_per_block=[0], paddings=None, paddings_per_block_multihead=None, preprocessing_CNN=None, random_permut=False, repeat_permut=1, seed=0, set_global_param=[], start_epoch=0, strides=None, thr_bin_act=[0.0, 0.0], thr_bin_act_test=[0.0, 0.0], type_blocks=['TTblock'], type_first_layer_block='float', verifier_mix='0', verifier_nproc=4, wait_load=False, workers=2)
global params: [('g_weight_binarizer', <class 'ttnet.modules_general.TernaryWeightWithMaskFn'>), ('g_use_scalar_scale_last_layer', True)]
network: TTnet(
  (features): Sequential(
    (0): InputQuantizer(0.1)
    (1): BNs()
    (2): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Binarize01Act()
    (4): Block_TT_1D(
      (conv1): Conv1d(1, 5, kernel_size=(3,), stride=(2,), bias=False)
      (bn1): BatchNorm1d(5, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv1d(5, 5, kernel_size=(1,), stride=(1,), bias=False)
      (bn2): BatchNorm1d(5, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (act): Binarize01Act()
    )
    (5): Flatten()
    (6): BinLinearPosv2(in_features=80, out_features=2, bias=False)
    (7): BatchNormStatsCallbak(2, scalar=True, cbd=0)
  )
)
WeightClip: 6 weight params
epoch: 0 ep.lr=0.005
[0, 0] loss=0.69/0.69 acc=78.12% tdata/train=(0.042,0.069)
sparsity@0: 26.25% ; 42/160.001=26.25%
test@0: acc=67.24% avg_acc=67.24% loss=0.71 pre_bn_acc=72.41%
epoch: 1 ep.lr=0.005
[1, 0] loss=0.66/0.66 acc=64.06% tdata/train=(0.194,0.201)
sparsity@1: 38.75% ; 62/160.001=38.75%
test@1: acc=72.41% avg_acc=69.83% loss=0.63 pre_bn_acc=72.41%
epoch: 2 ep.lr=0.005
[2, 0] loss=0.60/0.60 acc=76.56% tdata/train=(0.181,0.187)
sparsity@2: 43.12% ; 69/160.001=43.12%
test@2: acc=72.41% avg_acc=70.69% loss=0.63 pre_bn_acc=72.41%
epoch: 3 ep.lr=0.005
[3, 0] loss=0.59/0.59 acc=76.56% tdata/train=(0.198,0.204)
sparsity@3: 45.00% ; 72/160.001=45.00%
test@3: acc=77.59% avg_acc=72.41% loss=0.59 pre_bn_acc=77.59%
epoch: 4 ep.lr=0.005
[4, 0] loss=0.61/0.61 acc=75.00% tdata/train=(0.216,0.224)
sparsity@4: 47.50% ; 76/160.001=47.50%
test@4: acc=72.41% avg_acc=72.41% loss=0.64 pre_bn_acc=60.34%
epoch: 5 ep.lr=0.005
[5, 0] loss=0.59/0.59 acc=76.56% tdata/train=(0.214,0.224)
sparsity@5: 47.50% ; 76/160.001=47.50%
test@5: acc=72.41% avg_acc=72.41% loss=0.64 pre_bn_acc=70.69%
epoch: 6 ep.lr=0.005
[6, 0] loss=0.59/0.59 acc=71.09% tdata/train=(0.315,0.323)
sparsity@6: 47.50% ; 76/160.001=47.50%
test@6: acc=72.41% avg_acc=72.41% loss=0.64 pre_bn_acc=70.69%
epoch: 7 ep.lr=0.005
[7, 0] loss=0.59/0.59 acc=72.66% tdata/train=(0.157,0.164)
sparsity@7: 49.38% ; 79/160.001=49.37%
test@7: acc=68.97% avg_acc=71.98% loss=0.59 pre_bn_acc=70.69%
model choosing acc @7: 65.35%
best model update at @7
epoch: 8 ep.lr=0.005
[8, 0] loss=0.57/0.57 acc=74.22% tdata/train=(0.174,0.183)
sparsity@8: 50.62% ; 81/160.001=50.62%
test@8: acc=75.86% avg_acc=72.41% loss=0.58 pre_bn_acc=75.86%
model choosing acc @8: 70.18%
best model update at @8
epoch: 9 ep.lr=0.005
[9, 0] loss=0.54/0.54 acc=80.47% tdata/train=(0.167,0.179)
sparsity@9: 51.25% ; 82/160.001=51.25%
test@9: acc=77.59% avg_acc=72.93% loss=0.61 pre_bn_acc=75.86%
model choosing acc @9: 72.37%
best model update at @9
